syntax = "proto3";
package taskflow.task.v1;
option go_package = "github.com/Sol1tud9/taskflow/internal/pb/task_api";

import "models/task.proto";
import "google/api/annotations.proto";

service TaskService {
    rpc CreateTask(CreateTaskRequest) returns (CreateTaskResponse) {
        option (google.api.http) = {
            post: "/api/v1/tasks"
            body: "*"
        };
    }

    rpc GetTask(GetTaskRequest) returns (GetTaskResponse) {
        option (google.api.http) = {
            get: "/api/v1/tasks/{id}"
        };
    }

    rpc ListTasks(ListTasksRequest) returns (ListTasksResponse) {
        option (google.api.http) = {
            get: "/api/v1/tasks"
        };
    }

    rpc UpdateTask(UpdateTaskRequest) returns (UpdateTaskResponse) {
        option (google.api.http) = {
            patch: "/api/v1/tasks/{id}"
            body: "*"
        };
    }

    rpc DeleteTask(DeleteTaskRequest) returns (DeleteTaskResponse) {
        option (google.api.http) = {
            delete: "/api/v1/tasks/{id}"
        };
    }

    rpc GetTaskHistory(GetTaskHistoryRequest) returns (GetTaskHistoryResponse) {
        option (google.api.http) = {
            get: "/api/v1/tasks/{task_id}/history"
        };
    }
}

message CreateTaskRequest {
    string title = 1;
    string description = 2;
    string priority = 3;
    string assignee_id = 4;
    string creator_id = 5;
    string team_id = 6;
    int64 due_date = 7;
}

message CreateTaskResponse {
    taskflow.models.v1.Task task = 1;
}

message GetTaskRequest {
    string id = 1;
}

message GetTaskResponse {
    taskflow.models.v1.Task task = 1;
}

message ListTasksRequest {
    string team_id = 1;
    string assignee_id = 2;
    string status = 3;
    int32 limit = 4;
    int32 offset = 5;
}

message ListTasksResponse {
    repeated taskflow.models.v1.Task tasks = 1;
    int32 total = 2;
}

message UpdateTaskRequest {
    string id = 1;
    string title = 2;
    string description = 3;
    string status = 4;
    string priority = 5;
    string assignee_id = 6;
    int64 due_date = 7;
}

message UpdateTaskResponse {
    taskflow.models.v1.Task task = 1;
}

message DeleteTaskRequest {
    string id = 1;
}

message DeleteTaskResponse {
    bool success = 1;
}

message GetTaskHistoryRequest {
    string task_id = 1;
}

message GetTaskHistoryResponse {
    repeated taskflow.models.v1.TaskHistory history = 1;
}

